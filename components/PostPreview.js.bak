import React, {useState, useEffect, useRef} from 'react';
import {View, Image, ActivityIndicator, StyleSheet} from 'react-native';
import WebView from 'react-native-webview';
import {Scripts, rCanvas} from './scripts';
import ViewShot from 'react-native-view-shot';

onCapture = (uri) => {
  console.log('do something with ', uri);
};

const PostPreview = ({loading, shareURL, username}) => {
  const viewShot = useRef(null);

  // useEffect(() => {
  //   viewShot.capture().then((uri) => {
  //     console.log('do something with ', uri);
  //   });
  // });

  const onCap = (uri) => {
    // viewShot.capture().then((uri) => {
    //   console.log('do something with ', uri);
    // });
    console.log('do something with ', uri);
  };
  console.log(viewShot && viewShot.current);
  if (!shareURL)
    shareURL =
      'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAeAB4AAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAERAYYDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9U6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiimMxHSgB9N3Vj6t4otdJYQ83N23C20HzOfw7fjWcttr2tyb7iddItT0ggG+U/VjwPyoA6G61K2slLXE8cKjvI4FZknjfRI+Pt6SH/pkrP/IGmWvgjSYmEktubuYf8tLljIfrzWxHY28IxHDHH/uoBQBjf8J5o3eeYD1NtLj/ANBqaHxnotxgLqEIY8BXOw/ka2DGGGCAR9KrXGk2V2pWa1hkB67kFAE8NzHOu6N1kHqpyKkFc5N4JsIW32Ek2mSdQ1u+F/FTxUH9o654f3fbIRq9mOfPtl2yqPdO/wCFAHV0Vn6XrlprEHm2kyyDoy/xKfQjqKv0ALRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRTGoAcelcrfazd61fNp+jsoVeLi8YZWL/AGV9W/lS67fT6lfrounS7JGG66nH/LKM9h/tGtzS9Og0q1jtrePZGo9Op9T70AV9F8P2mjxkRp5kzcvcScu59Sa1Ni+lOooASloooAKKKKAEKhuoprKPSn0UAc9qvhlZphe6fL/Z+oL/AMtEHyyezjuKdoPiNr6ZrG+jFnqcX34c/K4/vKe4rePSsXX9DGrwpJE/kX0B3wTgcq3v7UAbdFYfhnXDqkMkVwvk39ufLuIj2b1HsRzW3QAtFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAlZfiLVV0fS5rgDdIMLGndnPAFabNiuWvl/trxhBa53W+nx+e69jI3Cg/QZP40AaPhrR30qxDTHzLydvNnk7lj2+g6VtUg6CloAKKKKACiiigAooooAKKKKACmspbpTqKAOW8S28mj3kOuwL/q8R3SL/HGT1+oNdHbSrNGsiNuRgGDDoQe9F5ClzbSR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';
  if (loading) {
    return (
      <View style={Styles.center}>
        <ActivityIndicator size="large" color="#000" />
      </View>
    );
  } else {
    return (
      <>
        {/* <ViewShot onCapture={this.onCapture} captureMode="mount"> */}
        <ViewShot ref={viewShot} captureMode="mount" onCapture={onCap()}>
          <Image
            style={Styles.center}
            source={{
              uri: shareURL,
            }}
          />
        </ViewShot>
      </>
    );
  }
};

const Styles = StyleSheet.create({
  center: {
    flex: 1,
    height: 500,
    width: 500,
    marginLeft: 50,
    margin: 'auto',
    alignItems: 'center',
    justifyContent: 'center',
    resizeMode: 'contain',
  },
  center_darkbg: {
    flex: 1,
    alignItems: 'center',
    justifyContent: 'center',
    backgroundColor: '#282828',
  },
  image_darkbg: {
    width: '100%',
    height: '100%',
    resizeMode: 'contain',
    backgroundColor: '#282828',
  },
});

export default PostPreview;
